# Workmate AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆ - å®Œå…¨ä½¿ç”¨æ›¸

## ğŸ“‹ ç›®æ¬¡

1. [ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦](#ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦)
2. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ](#ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ)
3. [æŠ€è¡“ä»•æ§˜](#æŠ€è¡“ä»•æ§˜)
4. [ç’°å¢ƒæ§‹ç¯‰æ‰‹é †](#ç’°å¢ƒæ§‹ç¯‰æ‰‹é †)
5. [æ©Ÿèƒ½è©³ç´°](#æ©Ÿèƒ½è©³ç´°)
6. [ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰](#ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰)
7. [ç®¡ç†è€…ã‚¬ã‚¤ãƒ‰](#ç®¡ç†è€…ã‚¬ã‚¤ãƒ‰)
8. [APIä»•æ§˜](#apiä»•æ§˜)
9. [ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ](#ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ)
10. [ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](#ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°)
11. [é‹ç”¨ãƒ»ä¿å®ˆ](#é‹ç”¨ä¿å®ˆ)

---

## ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦

### Workmate AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã¨ã¯

**Workmate**ã¯ã€ä¼æ¥­å†…ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã‚’æ´»ç”¨ã—ãŸé«˜æ€§èƒ½AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã§ã™ã€‚Google Gemini 2.0-flash-expã‚’æ­è¼‰ã—ã€PDFã€Excelã€å‹•ç”»ãªã©ã®å¤šæ§˜ãªãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‡¦ç†ãƒ»åˆ†æã—ã¦ã€å¾“æ¥­å“¡ã®è³ªå•ã«çš„ç¢ºãªå›ç­”ã‚’æä¾›ã—ã¾ã™ã€‚

### ğŸ¯ ä¸»ãªç‰¹å¾´

- **ğŸ¤– é«˜åº¦ãªAIå¿œç­”**: Google Gemini 2.0-flash-exp ã«ã‚ˆã‚‹é«˜ç²¾åº¦ãªè³ªå•å¿œç­”
- **ğŸ“ å¤šæ§˜ãªãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œ**: PDFï¼ˆOCRå¯¾å¿œï¼‰ã€Excelã€ãƒ†ã‚­ã‚¹ãƒˆã€å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†
- **ğŸ¢ ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆ**: ä¼æ¥­åˆ¥ã®å®Œå…¨ãªãƒ‡ãƒ¼ã‚¿åˆ†é›¢
- **ğŸ‘¥ æ¨©é™ç®¡ç†**: å½¹å‰²ãƒ™ãƒ¼ã‚¹ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆå¾“æ¥­å“¡ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ç®¡ç†è€…ï¼‰
- **ğŸ“Š é«˜åº¦ãªåˆ†æ**: 6ã¤ã®è¦–ç‚¹ã‹ã‚‰ã®ãƒ“ã‚¸ãƒã‚¹åˆ†ææ©Ÿèƒ½
- **ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: ä¼æ¥­ãƒ¬ãƒ™ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œ

### åˆ©ç”¨å¯¾è±¡

| å¯¾è±¡ | ä¸»ãªç”¨é€” |
|------|----------|
| **å¾“æ¥­å“¡** | æ—¥å¸¸æ¥­å‹™ã§ã®æƒ…å ±æ¤œç´¢ãƒ»è³ªå•å¿œç­” |
| **äººäº‹ãƒ»ç·å‹™** | å°±æ¥­è¦å‰‡ã€å„ç¨®æ‰‹ç¶šãã®æ¡ˆå†… |
| **å–¶æ¥­éƒ¨é–€** | å•†å“æƒ…å ±ã€å–¶æ¥­è³‡æ–™ã®æ´»ç”¨ |
| **æŠ€è¡“éƒ¨é–€** | æŠ€è¡“ä»•æ§˜æ›¸ã€é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã®å‚ç…§ |
| **ã‚«ã‚¹ã‚¿ãƒãƒ¼ã‚µãƒãƒ¼ãƒˆ** | FAQã€å¯¾å¿œãƒãƒ‹ãƒ¥ã‚¢ãƒ«ã®æ´»ç”¨ |
| **ç®¡ç†è€…** | ã‚·ã‚¹ãƒ†ãƒ ç®¡ç†ã€åˆ©ç”¨çŠ¶æ³åˆ†æ |

---

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
workmate/
â”œâ”€â”€ ğŸ“ Chatbot-Frontend-main/          # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ (React + TypeScript)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/               # UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ admin/               # ç®¡ç†è€…ãƒ‘ãƒãƒ«é–¢é€£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AdminPanel.tsx    # ãƒ¡ã‚¤ãƒ³ç®¡ç†ãƒ‘ãƒãƒ«
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AnalysisTab.tsx   # åˆ†æã‚¿ãƒ–
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ChatHistoryTab.tsx # ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã‚¿ãƒ–
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ DemoStatsTab.tsx  # ãƒ‡ãƒ¢çµ±è¨ˆã‚¿ãƒ–
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ EmployeeUsageTab.tsx # å¾“æ¥­å“¡åˆ©ç”¨çŠ¶æ³
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ PlanHistoryTab.tsx # ãƒ—ãƒ©ãƒ³å±¥æ­´ã‚¿ãƒ–
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ResourcesTab.tsx  # ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ã‚¿ãƒ–
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ UserManagementTab.tsx # ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚¿ãƒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ ApplicationForm.tsx   # ç”³è«‹ãƒ•ã‚©ãƒ¼ãƒ 
â”‚   â”‚   â”‚   â”œâ”€â”€ BillingTab.tsx       # è«‹æ±‚ã‚¿ãƒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ DemoLimits.tsx       # åˆ©ç”¨åˆ¶é™è¡¨ç¤º
â”‚   â”‚   â”‚   â”œâ”€â”€ GoogleDriveAuth.tsx  # Google Driveèªè¨¼
â”‚   â”‚   â”‚   â””â”€â”€ SourceCitation.tsx   # ã‚½ãƒ¼ã‚¹å¼•ç”¨è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ contexts/                # React Context
â”‚   â”‚   â”‚   â”œâ”€â”€ AuthContext.tsx      # èªè¨¼ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â”‚   â”‚   â”‚   â””â”€â”€ CompanyContext.tsx   # ä¼šç¤¾ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â”‚   â”‚   â”œâ”€â”€ utils/                   # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”‚   â”‚   â”‚   â”œâ”€â”€ googleConfig.ts      # Googleè¨­å®š
â”‚   â”‚   â”‚   â””â”€â”€ validation.ts        # ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”œâ”€â”€ App.tsx                  # ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx        # ãƒãƒ£ãƒƒãƒˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx            # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”‚   â”œâ”€â”€ AdminPanel.tsx           # ç®¡ç†è€…ãƒ‘ãƒãƒ«
â”‚   â”‚   â”œâ”€â”€ CompanySettings.tsx      # ä¼šç¤¾è¨­å®š
â”‚   â”‚   â”œâ”€â”€ UserGuide.tsx            # ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰
â”‚   â”‚   â””â”€â”€ api.ts                   # APIé€šä¿¡
â”‚   â”œâ”€â”€ public/                      # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”‚   â”œâ”€â”€ package.json                 # ä¾å­˜é–¢ä¿‚å®šç¾©
â”‚   â”œâ”€â”€ vite.config.ts              # Viteè¨­å®š
â”‚   â””â”€â”€ vercel.json                  # Vercelãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®š
â”‚
â”œâ”€â”€ ğŸ“ Chatbot-backend-main/           # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ (Python + FastAPI)
â”‚   â”œâ”€â”€ modules/                     # ã‚³ã‚¢ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”‚   â”œâ”€â”€ auth.py                  # èªè¨¼æ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ chat.py                  # ãƒãƒ£ãƒƒãƒˆå‡¦ç†
â”‚   â”‚   â”œâ”€â”€ company.py               # ä¼šç¤¾ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ admin.py                 # ç®¡ç†è€…æ©Ÿèƒ½
â”‚   â”‚   â”œâ”€â”€ database.py              # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶š
â”‚   â”‚   â”œâ”€â”€ models.py                # ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
â”‚   â”‚   â”œâ”€â”€ resource.py              # ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ token_counter.py         # ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡è¿½è·¡
â”‚   â”‚   â”œâ”€â”€ knowledge_base.py        # çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ç®¡ç†
â”‚   â”‚   â””â”€â”€ knowledge/               # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‡¦ç†
â”‚   â”‚       â”œâ”€â”€ api.py               # APIé–¢é€£å‡¦ç†
â”‚   â”‚       â”œâ”€â”€ base.py              # åŸºæœ¬å‡¦ç†
â”‚   â”‚       â”œâ”€â”€ excel.py             # Excelå‡¦ç†
â”‚   â”‚       â”œâ”€â”€ google_drive.py      # Google Driveé€£æº
â”‚   â”‚       â”œâ”€â”€ ocr.py               # OCRå‡¦ç†
â”‚   â”‚       â”œâ”€â”€ pdf.py               # PDFå‡¦ç†
â”‚   â”‚       â”œâ”€â”€ text.py              # ãƒ†ã‚­ã‚¹ãƒˆå‡¦ç†
â”‚   â”‚       â””â”€â”€ url.py               # URLå‡¦ç†
â”‚   â”œâ”€â”€ main.py                      # FastAPIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚   â”œâ”€â”€ requirements.txt             # Pythonä¾å­˜é–¢ä¿‚
â”‚   â”œâ”€â”€ database_schema.py           # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ
â”‚   â”œâ”€â”€ supabase_adapter.py          # Supabaseã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼
â”‚   â””â”€â”€ setup_supabase.py            # SupabaseåˆæœŸè¨­å®š
â”‚
â”œâ”€â”€ ğŸ“„ README.md                       # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦
â”œâ”€â”€ ğŸ“„ USER_MANUAL.md                  # æŠ€è¡“ãƒãƒ‹ãƒ¥ã‚¢ãƒ«
â”œâ”€â”€ ğŸ“„ CLIENT_GUIDE.md                 # ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚¬ã‚¤ãƒ‰
â””â”€â”€ ğŸ“„ nginx-workmatechat.conf         # Nginxè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
```

### ãƒ•ã‚¡ã‚¤ãƒ«è©³ç´°

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | æ©Ÿèƒ½ | é‡è¦åº¦ |
|----------|------|--------|
| `App.tsx` | ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š | â­â­â­ |
| `ChatInterface.tsx` | ãƒãƒ£ãƒƒãƒˆç”»é¢ã®ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | â­â­â­ |
| `AdminPanel.tsx` | ç®¡ç†è€…ãƒ‘ãƒãƒ«ã®ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | â­â­â­ |
| `api.ts` | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã¨ã®é€šä¿¡å‡¦ç† | â­â­â­ |
| `contexts/AuthContext.tsx` | èªè¨¼çŠ¶æ…‹ç®¡ç† | â­â­â­ |
| `contexts/CompanyContext.tsx` | ä¼šç¤¾æƒ…å ±ç®¡ç† | â­â­ |

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ä¸»è¦ãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | æ©Ÿèƒ½ | é‡è¦åº¦ |
|----------|------|--------|
| `main.py` | FastAPIã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ | â­â­â­ |
| `modules/chat.py` | ãƒãƒ£ãƒƒãƒˆå‡¦ç†ã¨AIå¿œç­”ç”Ÿæˆ | â­â­â­ |
| `modules/auth.py` | èªè¨¼ãƒ»èªå¯æ©Ÿèƒ½ | â­â­â­ |
| `modules/admin.py` | ç®¡ç†è€…æ©Ÿèƒ½ | â­â­â­ |
| `modules/database.py` | ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç®¡ç† | â­â­â­ |
| `modules/knowledge_base.py` | çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ç®¡ç† | â­â­â­ |
| `supabase_adapter.py` | Supabaseã¨ã®é€£æº | â­â­â­ |

---

## æŠ€è¡“ä»•æ§˜

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

```json
{
  "ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯": "React 18.2.0",
  "è¨€èª": "TypeScript 5.3.3",
  "ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«": "Vite 5.1.3",
  "UIãƒ©ã‚¤ãƒ–ãƒ©ãƒª": "Material-UI 5.15.10",
  "ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°": "React Router 6.22.1",
  "HTTPé€šä¿¡": "Axios >= 1.8.2",
  "ãƒãƒ£ãƒ¼ãƒˆ": "Chart.js 4.4.1",
  "ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰": "React Dropzone 14.2.3",
  "èªè¨¼": "Google Auth Library 10.0.0-rc.3",
  "çŠ¶æ…‹ç®¡ç†": "React Context API"
}
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

```python
{
    "ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯": "FastAPI 0.109.2",
    "Webã‚µãƒ¼ãƒãƒ¼": "Uvicorn 0.27.1",
    "AI": "Google Generative AI 0.3.2 (Gemini 2.0-flash-exp)",
    "ãƒ‡ãƒ¼ã‚¿å‡¦ç†": "Pandas 2.2.0",
    "ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‡¦ç†": {
        "PDF": "PyPDF2 3.0.1, PyMuPDF 1.23.7",
        "Excel": "openpyxl 3.1.2",
        "OCR": "pdf2image 1.16.3, Pillow >= 10.3.0",
        "ç”»åƒ": "Pillow >= 10.3.0"
    },
    "Webå‡¦ç†": {
        "ã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚°": "BeautifulSoup4 4.12.2",
        "ãƒ–ãƒ©ã‚¦ã‚¶è‡ªå‹•åŒ–": "Playwright",
        "å‹•ç”»å‡¦ç†": "yt-dlp, youtube_transcript_api"
    },
    "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹": "PostgreSQL (Supabase), psycopg2-binary 2.9.10",
    "éåŒæœŸå‡¦ç†": "asyncpg 0.30.0, aiofiles 24.1.0",
    "ãã®ä»–": "boto3 1.37.22, tiktoken"
}
```

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ

#### ä¸»è¦ãƒ†ãƒ¼ãƒ–ãƒ«

**1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† (users)**
```sql
CREATE TABLE users (
    id VARCHAR(255) PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    name VARCHAR(255) NOT NULL,
    role VARCHAR(50) DEFAULT 'employee',
    company_id INTEGER REFERENCES companies(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**2. ä¼šç¤¾ç®¡ç† (companies)**
```sql
CREATE TABLE companies (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    plan_type VARCHAR(50) DEFAULT 'demo',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**3. ãƒãƒ£ãƒƒãƒˆå±¥æ­´ (chat_history)**
```sql
CREATE TABLE chat_history (
    id VARCHAR(255) PRIMARY KEY,
    user_message TEXT NOT NULL,
    bot_response TEXT NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    category VARCHAR(100),
    sentiment VARCHAR(20),
    employee_id VARCHAR(255),
    employee_name VARCHAR(255),
    source_document VARCHAR(255),
    source_page VARCHAR(50),
    user_id VARCHAR(255),
    company_id INTEGER
);
```

**4. åˆ©ç”¨åˆ¶é™ (usage_limits)**
```sql
CREATE TABLE usage_limits (
    user_id VARCHAR(255) PRIMARY KEY,
    document_uploads_used INT DEFAULT 0,
    document_uploads_limit INT DEFAULT 3,
    questions_used INT DEFAULT 0,
    questions_limit INT DEFAULT 200,
    is_unlimited BOOLEAN DEFAULT FALSE,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**5. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚½ãƒ¼ã‚¹ (document_sources)**
```sql
CREATE TABLE document_sources (
    id SERIAL PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    type VARCHAR(50) NOT NULL,
    content TEXT,
    uploaded_by VARCHAR(255),
    company_id INTEGER,
    active BOOLEAN DEFAULT TRUE,
    uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

## ç’°å¢ƒæ§‹ç¯‰æ‰‹é †

### å‰ææ¡ä»¶

- **Node.js**: 18.0.0 ä»¥ä¸Š
- **Python**: 3.9 ä»¥ä¸Š
- **Git**: æœ€æ–°ç‰ˆ
- **Google AI API Key**: Gemini API ã®åˆ©ç”¨æ¨©é™
- **Supabase ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç”¨

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/your-repo/workmate.git
cd workmate
```

### 2. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç’°å¢ƒæ§‹ç¯‰

#### 2.1 ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
cd Chatbot-backend-main

# ä»®æƒ³ç’°å¢ƒã®ä½œæˆ
python -m venv venv

# ä»®æƒ³ç’°å¢ƒã®æœ‰åŠ¹åŒ–
# Windows:
venv\Scripts\activate
# macOS/Linux:
source venv/bin/activate

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
pip install -r requirements.txt

# Playwrightãƒ–ãƒ©ã‚¦ã‚¶ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
playwright install
```

#### 2.2 ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š

```bash
# Google AIè¨­å®š
GOOGLE_API_KEY=your_google_gemini_api_key_here

# Supabaseè¨­å®š
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your_supabase_anon_key

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
COMPANY_NAME="Your Company Name"
PORT=8083

# ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆãƒ—ãƒ­ã‚­ã‚·ç’°å¢ƒã®å ´åˆï¼‰
HTTP_PROXY=http://proxy.company.com:8080
HTTPS_PROXY=https://proxy.company.com:8080

# èªè¨¼ãŒå¿…è¦ãªãƒ—ãƒ­ã‚­ã‚·ã®å ´åˆ
# HTTP_PROXY=http://username:password@proxy.company.com:8080
# HTTPS_PROXY=https://username:password@proxy.company.com:8080

# AssemblyAIï¼ˆéŸ³å£°å‡¦ç†ç”¨ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
ASSEMBLYAI_API_KEY=your_assemblyai_key

# WebShare Proxyï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
WEBSHAREPROXY_USERNAME=your_proxy_username
WEBSHAREPROXY_PASSWORD=your_proxy_password
```

#### 2.3 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–

```bash
# Supabaseã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
python setup_supabase.py

# ã¾ãŸã¯æ‰‹å‹•ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–
python -c "from modules.database import init_db; init_db()"
```

#### 2.4 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
# é–‹ç™ºç’°å¢ƒã§ã®èµ·å‹•
python main.py

# ã¾ãŸã¯ uvicorn ã§ã®èµ·å‹•
uvicorn main:app --host 0.0.0.0 --port 8083 --reload
```

### 3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç’°å¢ƒæ§‹ç¯‰

#### 3.1 ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
cd Chatbot-Frontend-main

# ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install
```

#### 3.2 ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

`.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆï¼š

```bash
# é–‹ç™ºç’°å¢ƒ
VITE_API_URL=http://localhost:8083

# æœ¬ç•ªç’°å¢ƒ
# VITE_API_URL=https://your-backend-domain.com
```

#### 3.3 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼èµ·å‹•

```bash
# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•
npm run dev

# ãƒ“ãƒ«ãƒ‰ï¼ˆæœ¬ç•ªç”¨ï¼‰
npm run build
```

### 4. å‹•ä½œç¢ºèª

1. **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ç¢ºèª**: http://localhost:8083/docs ã§APIä»•æ§˜ã‚’ç¢ºèª
2. **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ç¢ºèª**: http://localhost:5173 ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹
3. **åˆæœŸãƒ­ã‚°ã‚¤ãƒ³**: 
   - ãƒ¡ãƒ¼ãƒ«: `queue@queuefood.co.jp`
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: `John.Queue2025`

---

## æ©Ÿèƒ½è©³ç´°

### ğŸ¤– AI ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½

#### æ¦‚è¦
Google Gemini 2.0-flash-exp ã‚’ä½¿ç”¨ã—ãŸé«˜ç²¾åº¦ãªè³ªå•å¿œç­”ã‚·ã‚¹ãƒ†ãƒ 

#### ä¸»è¦æ©Ÿèƒ½

**1. è³ªå•å¿œç­”å‡¦ç†**
- è‡ªç„¶è¨€èªã§ã®è³ªå•å—ä»˜
- çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãå›ç­”ç”Ÿæˆ
- æƒ…å ±ã‚½ãƒ¼ã‚¹ã®æ˜ç¤º
- ä¼šè©±å±¥æ­´ã®è€ƒæ…®ï¼ˆæœ€å¤§5ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼‰

**2. æ„Ÿæƒ…ãƒ»ã‚«ãƒ†ã‚´ãƒªåˆ†æ**
- è³ªå•ã®æ„Ÿæƒ…åˆ†æï¼ˆãƒã‚¸ãƒ†ã‚£ãƒ–ãƒ»ãƒã‚¬ãƒ†ã‚£ãƒ–ãƒ»ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«ï¼‰
- ã‚«ãƒ†ã‚´ãƒªè‡ªå‹•åˆ†é¡
- ãƒ“ã‚¸ãƒã‚¹åˆ†æã¸ã®æ´»ç”¨

**3. åˆ©ç”¨åˆ¶é™ç®¡ç†**
- ãƒ‡ãƒ¢ãƒ—ãƒ©ãƒ³: 10è³ªå•/æœˆ
- æœ¬æ ¼ãƒ—ãƒ©ãƒ³: ç„¡åˆ¶é™
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ åˆ¶é™ãƒã‚§ãƒƒã‚¯

#### å®Ÿè£…è©³ç´°

```python
# modules/chat.py ã®ä¸»è¦æ©Ÿèƒ½

async def process_chat(message: ChatMessage, db: Connection, current_user: dict):
    """
    ãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼:
    1. åˆ©ç”¨åˆ¶é™ãƒã‚§ãƒƒã‚¯
    2. ä¼šç¤¾å›ºæœ‰ã®çŸ¥è­˜ãƒ™ãƒ¼ã‚¹å–å¾—
    3. ä¼šè©±å±¥æ­´ã®æ§‹ç¯‰
    4. Gemini API ã«ã‚ˆã‚‹å›ç­”ç”Ÿæˆ
    5. æ„Ÿæƒ…ãƒ»ã‚«ãƒ†ã‚´ãƒªåˆ†æ
    6. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜
    7. åˆ©ç”¨åˆ¶é™æ›´æ–°
    """
```

### ğŸ“ ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‡¦ç†æ©Ÿèƒ½

#### ã‚µãƒãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼

| å½¢å¼ | æœ€å¤§ã‚µã‚¤ã‚º | å¯¾å¿œæ©Ÿèƒ½ | å‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ³ |
|------|-----------|----------|-------------|
| **PDF** | 10MB | OCRã€è¤‡æ•°ãƒšãƒ¼ã‚¸ã€ç”»åƒæŠ½å‡º | PyPDF2, PyMuPDF, pdf2image |
| **Excel** | 5MB | è¤‡æ•°ã‚·ãƒ¼ãƒˆã€ãƒ‡ãƒ¼ã‚¿åˆ†æ | openpyxl, pandas |
| **ãƒ†ã‚­ã‚¹ãƒˆ** | 2MB | ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã€Markdown | å†…è”µå‡¦ç† |
| **å‹•ç”»** | 500MB | å­—å¹•æŠ½å‡ºã€éŸ³å£°è»¢å†™ | yt-dlp, AssemblyAI |
| **URL** | åˆ¶é™ãªã— | Webã‚¹ã‚¯ãƒ¬ã‚¤ãƒ”ãƒ³ã‚° | Playwright, BeautifulSoup |

#### å‡¦ç†ãƒ•ãƒ­ãƒ¼

```python
# modules/knowledge/ ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼

# 1. PDFå‡¦ç† (modules/knowledge/pdf.py)
async def process_pdf_file(content: bytes, file_name: str):
    """
    PDFå‡¦ç†:
    1. ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡º
    2. OCRå‡¦ç†ï¼ˆç”»åƒãƒ™ãƒ¼ã‚¹PDFï¼‰
    3. ãƒšãƒ¼ã‚¸åˆ†å‰²
    4. DataFrameå¤‰æ›
    """

# 2. Excelå‡¦ç† (modules/knowledge/excel.py)
def process_excel_file(content: bytes, file_name: str):
    """
    Excelå‡¦ç†:
    1. è¤‡æ•°ã‚·ãƒ¼ãƒˆèª­è¾¼
    2. ãƒ‡ãƒ¼ã‚¿å‹è‡ªå‹•åˆ¤å®š
    3. è¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿ã®æ§‹é€ åŒ–
    """

# 3. URLå‡¦ç† (modules/knowledge/url.py)
async def extract_text_from_url(url: str):
    """
    URLå‡¦ç†:
    1. Playwright ã§ã®å‹•çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å–å¾—
    2. BeautifulSoup ã§ã®HTMLè§£æ
    3. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æŠ½å‡º
    """
```

### ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½

#### æ¨©é™ä½“ç³»

| å½¹å‰² | æ¨©é™ | ã‚¢ã‚¯ã‚»ã‚¹ç¯„å›² |
|------|------|-------------|
| **employee** | ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã®ã¿ | è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã®ã¿ |
| **user** | ãƒãƒ£ãƒƒãƒˆ + ç®¡ç†æ©Ÿèƒ½ | åŒä¸€ä¼šç¤¾ã®ãƒ‡ãƒ¼ã‚¿ |
| **admin** | ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ç®¡ç† | å…¨ãƒ‡ãƒ¼ã‚¿ï¼ˆåˆ¶é™ã‚ã‚Šï¼‰ |
| **ç‰¹åˆ¥ç®¡ç†è€…** | å…¨æ¨©é™ | å…¨ãƒ‡ãƒ¼ã‚¿ãƒ»å…¨æ©Ÿèƒ½ |

#### å®Ÿè£…è©³ç´°

```python
# modules/auth.py ã®èªè¨¼ãƒ•ãƒ­ãƒ¼

def authenticate_user(email: str, password: str, db: Connection):
    """
    èªè¨¼ãƒ•ãƒ­ãƒ¼:
    1. Basicèªè¨¼ï¼ˆemail:passwordï¼‰
    2. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥æ¤œè¨¼
    3. æ¨©é™æƒ…å ±å–å¾—
    4. ä¼šç¤¾æƒ…å ±å–å¾—
    """

def check_usage_limits(user_id: str, action_type: str, db: Connection):
    """
    åˆ©ç”¨åˆ¶é™ãƒã‚§ãƒƒã‚¯:
    1. ç¾åœ¨ã®ä½¿ç”¨é‡å–å¾—
    2. åˆ¶é™å€¤ã¨ã®æ¯”è¼ƒ
    3. ç„¡åˆ¶é™ãƒ•ãƒ©ã‚°ç¢ºèª
    """
```

### ğŸ“Š åˆ†ææ©Ÿèƒ½

#### 6ã¤ã®åˆ†æè¦–ç‚¹

**1. é »ç¹ãªãƒˆãƒ”ãƒƒã‚¯ã¨ãƒˆãƒ¬ãƒ³ãƒ‰**
- ã‚ˆãè³ªå•ã•ã‚Œã‚‹å†…å®¹ã®å‚¾å‘åˆ†æ
- æ™‚ç³»åˆ—ã§ã®å¤‰åŒ–è¿½è·¡

**2. åŠ¹ç‡åŒ–æ©Ÿä¼š**
- æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹æ”¹å–„ã®ææ¡ˆ
- è‡ªå‹•åŒ–å¯èƒ½ãªä½œæ¥­ã®ç‰¹å®š

**3. ãƒ•ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒã‚¤ãƒ³ãƒˆ**
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å›°ã‚Šã”ã¨åˆ†æ
- ãƒã‚¬ãƒ†ã‚£ãƒ–æ„Ÿæƒ…ã®å‚¾å‘

**4. è£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹æ”¹å–„ææ¡ˆ**
- ãƒãƒ£ãƒƒãƒˆå†…å®¹ã‹ã‚‰è¦‹ãˆã‚‹æ”¹å–„æ¡ˆ
- é¡§å®¢ãƒ‹ãƒ¼ã‚ºã®æ´å¯Ÿ

**5. ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚®ãƒ£ãƒƒãƒ—**
- æƒ…å ±ä¼é”ã®èª²é¡Œç‰¹å®š
- éƒ¨é–€é–“ã®é€£æºå•é¡Œ

**6. å…·ä½“çš„æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**
- å®Ÿè¡Œå¯èƒ½ãªæ”¹å–„ç­–
- å„ªå…ˆåº¦ä»˜ãã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ 

#### å®Ÿè£…è©³ç´°

```python
# modules/admin.py ã®åˆ†ææ©Ÿèƒ½

async def analyze_chats(user_id: str, db: Connection, company_id: str):
    """
    ãƒãƒ£ãƒƒãƒˆåˆ†æãƒ•ãƒ­ãƒ¼:
    1. ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼/ä¼šç¤¾/å…¨ä½“ï¼‰
    2. çµ±è¨ˆè¨ˆç®—ï¼ˆã‚«ãƒ†ã‚´ãƒªã€æ„Ÿæƒ…ã€æ™‚ç³»åˆ—ï¼‰
    3. AI ã«ã‚ˆã‚‹æ´å¯Ÿç”Ÿæˆ
    4. ãƒ“ã‚¸ãƒã‚¹å‘ã‘ã®ææ¡ˆä½œæˆ
    """
```

---

## ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰

### ğŸš€ åˆ©ç”¨é–‹å§‹æ‰‹é †

#### 1. ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç™»éŒ²

1. **Webã‚µã‚¤ãƒˆã‚¢ã‚¯ã‚»ã‚¹**: `https://workmatechat.com`
2. **æ–°è¦ç™»éŒ²**: 
   - ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šï¼‰
   - æ°å
   - ä¼šç¤¾å
3. **è‡ªå‹•ãƒ­ã‚°ã‚¤ãƒ³**: ç™»éŒ²å®Œäº†å¾Œã€è‡ªå‹•çš„ã«ãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹

#### 2. åˆå›è¨­å®š

1. **ä¼šç¤¾åè¨­å®š**: å³ä¸Šè¨­å®šãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰æ­£å¼åç§°ã«å¤‰æ›´
2. **çŸ¥è­˜ãƒ™ãƒ¼ã‚¹æ§‹ç¯‰**: é–¢é€£æ–‡æ›¸ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
3. **å¾“æ¥­å“¡æ‹›å¾…**: ç®¡ç†è€…æ¨©é™ãŒã‚ã‚‹å ´åˆã€å¾“æ¥­å“¡ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ

### ğŸ’¬ ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã®ä½¿ç”¨æ–¹æ³•

#### åŸºæœ¬æ“ä½œ

1. **è³ªå•å…¥åŠ›**: ç”»é¢ä¸‹éƒ¨ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«è³ªå•ã‚’å…¥åŠ›
2. **é€ä¿¡**: Enter ã‚­ãƒ¼ã¾ãŸã¯é€ä¿¡ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. **AIå›ç­”**: æ•°ç§’ã§çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«åŸºã¥ãå›ç­”ã‚’è¡¨ç¤º
4. **å‡ºå…¸ç¢ºèª**: å›ç­”ã®æ ¹æ‹ ã¨ãªã£ãŸæ–‡æ›¸åã‚’ç¢ºèª

#### åŠ¹æœçš„ãªè³ªå•ã®ã‚³ãƒ„

| âŒ æ‚ªã„ä¾‹ | âœ… è‰¯ã„ä¾‹ |
|-----------|----------|
| ã€Œå£²ä¸Šã«ã¤ã„ã¦ã€ | ã€Œ2024å¹´12æœˆã®å£²ä¸Šå®Ÿç¸¾ã¨å‰å¹´åŒæœˆæ¯”ã‚’æ•™ãˆã¦ã€ |
| ã€Œæ‰‹ç¶šãã¯ï¼Ÿã€ | ã€Œæ–°å…¥ç¤¾å“¡ã®å…¥ç¤¾æ‰‹ç¶šãã®æµã‚Œã‚’è©³ã—ãæ•™ãˆã¦ã€ |
| ã€Œã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã€ | ã€Œãƒ­ã‚°ã‚¤ãƒ³æ™‚ã«ã€èªè¨¼ã‚¨ãƒ©ãƒ¼ã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã®å¯¾å‡¦æ³•ã€ |

#### ä¼šè©±æ©Ÿèƒ½

- **ç¶™ç¶šä¼šè©±**: å‰ã®è³ªå•ã¸ã®è¿½åŠ è³ªå•ã‚„è©³ç´°ç¢ºèªãŒå¯èƒ½
- **å±¥æ­´å‚ç…§**: æœ€å¤§5ã¤å‰ã®ä¼šè©±ã‚’è€ƒæ…®ã—ãŸå›ç­”
- **æ–‡è„ˆç†è§£**: ã€Œãã‚Œã«ã¤ã„ã¦è©³ã—ãã€ãªã©ã®æŒ‡ç¤ºèªã«ã‚‚å¯¾å¿œ

### ğŸ“„ ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰

#### å¯¾å¿œå½¢å¼ã¨åˆ¶é™

| ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ | æœ€å¤§ã‚µã‚¤ã‚º | ç‰¹å¾´ |
|-------------|-----------|------|
| PDF | 10MB | OCRå¯¾å¿œã€è¤‡æ•°ãƒšãƒ¼ã‚¸ |
| Excel (xlsx/xls) | 5MB | è¤‡æ•°ã‚·ãƒ¼ãƒˆå¯¾å¿œ |
| ãƒ†ã‚­ã‚¹ãƒˆ (.txt) | 2MB | ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ |
| å‹•ç”» (mp4/avi/webm) | 500MB | å­—å¹•ãƒ»éŸ³å£°æŠ½å‡º |

#### ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ‰‹é †

1. **ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ**: ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ— ã¾ãŸã¯ ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒœã‚¿ãƒ³
2. **è‡ªå‹•å‡¦ç†**: ã‚·ã‚¹ãƒ†ãƒ ãŒè‡ªå‹•çš„ã«å†…å®¹ã‚’è§£æãƒ»å­¦ç¿’
3. **å®Œäº†ç¢ºèª**: å‡¦ç†å®Œäº†é€šçŸ¥ã‚’ç¢ºèª
4. **ãƒãƒ£ãƒƒãƒˆãƒ†ã‚¹ãƒˆ**: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ãŸå†…å®¹ã«ã¤ã„ã¦è³ªå•

#### ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

- **ãƒ•ã‚¡ã‚¤ãƒ«å**: ã‚ã‹ã‚Šã‚„ã™ã„åå‰ã‚’ä»˜ã‘ã‚‹ï¼ˆä¾‹ï¼šå–¶æ¥­ãƒãƒ‹ãƒ¥ã‚¢ãƒ«_2024å¹´ç‰ˆ.pdfï¼‰
- **å†…å®¹ã®è³ª**: æ­£ç¢ºã§æœ€æ–°ã®æƒ…å ±ã®ã¿ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- **å®šæœŸæ›´æ–°**: å¤ã„æƒ…å ±ã¯ç„¡åŠ¹åŒ–ã—ã€æœ€æ–°ç‰ˆã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- **ã‚«ãƒ†ã‚´ãƒªåˆ†ã‘**: éƒ¨ç½²åˆ¥ãƒ»ç”¨é€”åˆ¥ã«æ•´ç†

### ğŸŒ URLç™»éŒ²æ©Ÿèƒ½

#### å¯¾å¿œã‚µã‚¤ãƒˆ

- **ä¼æ¥­ã‚µã‚¤ãƒˆ**: è£½å“ãƒšãƒ¼ã‚¸ã€FAQã€ãƒ‹ãƒ¥ãƒ¼ã‚¹
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: Confluenceã€Notionã€Google Docs
- **å‹•ç”»**: YouTubeï¼ˆå­—å¹•ã‚ã‚Šï¼‰
- **ä¸€èˆ¬ã‚µã‚¤ãƒˆ**: æŠ€è¡“è¨˜äº‹ã€æ¥­ç•Œæƒ…å ±

#### ç™»éŒ²æ‰‹é †

1. **URLå…¥åŠ›**: å¯¾è±¡ã‚µã‚¤ãƒˆã®URLã‚’å…¥åŠ›
2. **è‡ªå‹•å–å¾—**: ã‚·ã‚¹ãƒ†ãƒ ãŒè‡ªå‹•çš„ã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å–å¾—
3. **å‡¦ç†ç¢ºèª**: å–å¾—å†…å®¹ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§ç¢ºèª
4. **çŸ¥è­˜ãƒ™ãƒ¼ã‚¹è¿½åŠ **: æ‰¿èªå¾Œã€ãƒãƒ£ãƒƒãƒˆã§åˆ©ç”¨å¯èƒ½

---

## ç®¡ç†è€…ã‚¬ã‚¤ãƒ‰

### ğŸ›ï¸ ç®¡ç†è€…ãƒ‘ãƒãƒ«

#### ã‚¢ã‚¯ã‚»ã‚¹æ–¹æ³•

- **å¯¾è±¡ãƒ¦ãƒ¼ã‚¶ãƒ¼**: role ãŒ 'user' ã¾ãŸã¯ 'admin' ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼
- **ã‚¢ã‚¯ã‚»ã‚¹**: ãƒ­ã‚°ã‚¤ãƒ³å¾Œã€è‡ªå‹•çš„ã«ç®¡ç†è€…ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãŒè¡¨ç¤º

#### ãƒ¡ã‚¤ãƒ³æ©Ÿèƒ½

1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†**: å¾“æ¥­å“¡ã®è¿½åŠ ãƒ»å‰Šé™¤ãƒ»æ¨©é™è¨­å®š
2. **ãƒãƒ£ãƒƒãƒˆå±¥æ­´**: å…¨ç¤¾å“¡ã®ãƒãƒ£ãƒƒãƒˆå†…å®¹ç¢ºèª
3. **åˆ†ææ©Ÿèƒ½**: 6ã¤ã®è¦–ç‚¹ã‹ã‚‰ã®ãƒ“ã‚¸ãƒã‚¹åˆ†æ
4. **ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**: ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã®æœ‰åŠ¹/ç„¡åŠ¹åˆ‡ã‚Šæ›¿ãˆ
5. **ä½¿ç”¨çµ±è¨ˆ**: åˆ©ç”¨çŠ¶æ³ã®å¯è¦–åŒ–
6. **ãƒ‡ãƒ¢çµ±è¨ˆ**: ãƒ‡ãƒ¢ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆ©ç”¨çŠ¶æ³

### ğŸ‘¥ ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†

#### å¾“æ¥­å“¡ã®è¿½åŠ 

1. **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚¿ãƒ–**: ç®¡ç†è€…ãƒ‘ãƒãƒ«ã‹ã‚‰é¸æŠ
2. **æ–°è¦ä½œæˆ**:
   ```
   ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: å¾“æ¥­å“¡ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
   ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: åˆæœŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆ8æ–‡å­—ä»¥ä¸Šï¼‰
   æ°å: ãƒ•ãƒ«ãƒãƒ¼ãƒ 
   å½¹å‰²: employeeï¼ˆãƒãƒ£ãƒƒãƒˆã®ã¿ï¼‰/ userï¼ˆç®¡ç†æ¨©é™ä»˜ãï¼‰
   ```
3. **ç™»éŒ²å®Œäº†**: èªè¨¼æƒ…å ±ã‚’å¾“æ¥­å“¡ã«å…±æœ‰

#### æ¨©é™ç®¡ç†

| æ¨©é™ãƒ¬ãƒ™ãƒ« | è¨­å®šæ–¹æ³• | ã‚¢ã‚¯ã‚»ã‚¹ç¯„å›² |
|-----------|----------|-------------|
| **employee** | æ–°è¦ä½œæˆæ™‚ã«é¸æŠ | ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½ã®ã¿ |
| **user** | ç®¡ç†è€…ãŒè¨­å®š | ç®¡ç†æ©Ÿèƒ½ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ |
| **admin** | ç‰¹åˆ¥ç®¡ç†è€…ã®ã¿è¨­å®šå¯èƒ½ | ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ç®¡ç† |

#### åˆ©ç”¨åˆ¶é™è¨­å®š

```javascript
// ãƒ‡ãƒ¢ãƒ—ãƒ©ãƒ³ã®åˆ¶é™
{
  "questions_limit": 10,        // æœˆé–“è³ªå•æ•°
  "document_uploads_limit": 2,  // ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«æ•°
  "is_unlimited": false         // åˆ¶é™ãƒ•ãƒ©ã‚°
}

// æœ¬æ ¼ãƒ—ãƒ©ãƒ³ã®è¨­å®š
{
  "is_unlimited": true          // ç„¡åˆ¶é™åˆ©ç”¨
}
```

### ğŸ“Š åˆ†ææ©Ÿèƒ½

#### ãƒãƒ£ãƒƒãƒˆå±¥æ­´åˆ†æ

**åŸºæœ¬åˆ†æ**
- æœŸé–“åˆ¥åˆ©ç”¨çŠ¶æ³
- ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆ†é¡
- æ„Ÿæƒ…åˆ†æçµæœ
- ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥æ´»å‹•çŠ¶æ³

**è©³ç´°åˆ†æï¼ˆAIé§†å‹•ï¼‰**
1. **é »ç¹ãªãƒˆãƒ”ãƒƒã‚¯**: ã‚ˆãè³ªå•ã•ã‚Œã‚‹å†…å®¹ã®å‚¾å‘
2. **åŠ¹ç‡åŒ–æ©Ÿä¼š**: æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹æ”¹å–„ææ¡ˆ
3. **ãƒ•ãƒ©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å›°ã‚Šã”ã¨
4. **æ”¹å–„ææ¡ˆ**: è£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹ã®æ”¹å–„æ¡ˆ
5. **ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚®ãƒ£ãƒƒãƒ—**: æƒ…å ±ä¼é”ã®èª²é¡Œ
6. **æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: å…·ä½“çš„ãªæ”¹å–„ç­–

#### åˆ†æãƒ¬ãƒãƒ¼ãƒˆæ´»ç”¨

**æœˆæ¬¡ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ**
1. **ãƒ‡ãƒ¼ã‚¿æœŸé–“**: åˆ†æå¯¾è±¡æœŸé–“ã‚’è¨­å®š
2. **åˆ†æå®Ÿè¡Œ**: AIã«ã‚ˆã‚‹è©³ç´°åˆ†æã‚’å®Ÿè¡Œ
3. **ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ**: ãƒ“ã‚¸ãƒã‚¹å‘ã‘ã®æ´å¯Ÿãƒ¬ãƒãƒ¼ãƒˆ
4. **ã‚¢ã‚¯ã‚·ãƒ§ãƒ³è¨ˆç”»**: æ”¹å–„ç­–ã®å„ªå…ˆé †ä½ä»˜ã‘

**éƒ¨é–€åˆ¥åˆ†æ**
- äººäº‹ãƒ»ç·å‹™: åˆ¶åº¦æ¡ˆå†…ã®å……å®Ÿåº¦
- å–¶æ¥­: è£½å“çŸ¥è­˜ã®ç¿’å¾—çŠ¶æ³
- æŠ€è¡“: é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã®èª²é¡Œ
- ã‚µãƒãƒ¼ãƒˆ: é¡§å®¢å¯¾å¿œã®æ”¹å–„ç‚¹

### ğŸ—‚ï¸ ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†

#### ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†

**ä¸€è¦§è¡¨ç¤º**
- ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ¸ˆã¿ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§
- ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ãƒ»ã‚µã‚¤ã‚ºãƒ»ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ—¥æ™‚
- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ï¼ˆæœ‰åŠ¹/ç„¡åŠ¹ï¼‰

**æ“ä½œæ©Ÿèƒ½**
- **æœ‰åŠ¹åŒ–/ç„¡åŠ¹åŒ–**: ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§ä¸€æ‹¬æ“ä½œ
- **å‰Šé™¤**: ä¸è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã®å‰Šé™¤
- **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**: ãƒ•ã‚¡ã‚¤ãƒ«å†…å®¹ã®ç¢ºèª

#### çŸ¥è­˜ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–

**å®šæœŸãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹**
1. **æœˆæ¬¡ãƒ¬ãƒ“ãƒ¥ãƒ¼**: åˆ©ç”¨é »åº¦ã®ä½ã„ãƒ•ã‚¡ã‚¤ãƒ«ã®è¦‹ç›´ã—
2. **å†…å®¹æ›´æ–°**: å¤ã„æƒ…å ±ã®ç„¡åŠ¹åŒ–ã¨æ–°æƒ…å ±ã®è¿½åŠ 
3. **å“è³ªç®¡ç†**: ä¸æ­£ç¢ºãªæƒ…å ±æºã®é™¤å¤–
4. **ã‚«ãƒ†ã‚´ãƒªæ•´ç†**: ä½“ç³»çš„ãªåˆ†é¡ã®ç¶­æŒ

### ğŸ“ˆ ä½¿ç”¨çµ±è¨ˆãƒ»ç›£è¦–

#### å…¨ä½“çµ±è¨ˆ

```javascript
// çµ±è¨ˆæŒ‡æ¨™
{
  "total_users": 50,           // ç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°
  "active_users": 30,          // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆ7æ—¥ä»¥å†…ï¼‰
  "total_documents": 25,       // ç·ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•°
  "total_questions": 500,      // ç·è³ªå•æ•°
  "limit_reached_users": 5,    // åˆ¶é™åˆ°é”ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°
  "total_companies": 3         // ç·ä¼šç¤¾æ•°
}
```

#### ãƒ¦ãƒ¼ã‚¶ãƒ¼åˆ¥è©³ç´°

- **åˆ©ç”¨é »åº¦**: æ—¥åˆ¥ãƒ»é€±åˆ¥ãƒ»æœˆåˆ¥ã®è³ªå•æ•°
- **ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£**: æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³ã€æ´»å‹•ãƒ‘ã‚¿ãƒ¼ãƒ³
- **åˆ¶é™çŠ¶æ³**: ä½¿ç”¨é‡ã¨æ®‹ã‚Šåˆ¶é™
- **ã‚ˆãä½¿ç”¨ã™ã‚‹ã‚«ãƒ†ã‚´ãƒª**: è³ªå•å‚¾å‘ã®åˆ†æ

---

## APIä»•æ§˜

### èªè¨¼æ–¹å¼

```http
Authorization: Basic <base64(email:password)>
Content-Type: application/json
```

### ä¸»è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ

#### 1. èªè¨¼é–¢é€£

**ãƒ­ã‚°ã‚¤ãƒ³**
```http
POST /chatbot/api/auth/login
Content-Type: application/json

Request:
{
  "email": "user@company.com",
  "password": "password"
}

Response:
{
  "user": {
    "id": "user_id",
    "email": "user@company.com",
    "name": "ãƒ¦ãƒ¼ã‚¶ãƒ¼å",
    "role": "user",
    "company_id": 1
  },
  "message": "ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ"
}
```

**ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—**
```http
GET /chatbot/api/auth/me
Authorization: Basic <credentials>

Response:
{
  "id": "user_id",
  "email": "user@company.com",
  "name": "ãƒ¦ãƒ¼ã‚¶ãƒ¼å",
  "role": "user",
  "company_id": 1
}
```

#### 2. ãƒãƒ£ãƒƒãƒˆæ©Ÿèƒ½

**ãƒãƒ£ãƒƒãƒˆé€ä¿¡**
```http
POST /chatbot/api/chat
Authorization: Basic <credentials>
Content-Type: application/json

Request:
{
  "text": "è³ªå•å†…å®¹",
  "user_id": "user_id",
  "employee_id": "employee_id",
  "employee_name": "å¾“æ¥­å“¡å"
}

Response:
{
  "response": "AIå›ç­”",
  "source": "æƒ…å ±ã‚½ãƒ¼ã‚¹å (P.1)",
  "remaining_questions": 9,
  "limit_reached": false
}
```

#### 3. ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†

**ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰**
```http
POST /chatbot/api/upload-knowledge
Authorization: Basic <credentials>
Content-Type: multipart/form-data

Form Data:
- file: <PDF/Excel/Text/Video file>
- description: "ãƒ•ã‚¡ã‚¤ãƒ«ã®èª¬æ˜"

Response:
{
  "message": "ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚Œã€å‡¦ç†ã•ã‚Œã¾ã—ãŸ",
  "filename": "document.pdf",
  "size": 1024000,
  "type": "pdf"
}
```

**URLç™»éŒ²**
```http
POST /chatbot/api/submit-url
Authorization: Basic <credentials>
Content-Type: application/json

Request:
{
  "url": "https://example.com",
  "description": "ã‚µã‚¤ãƒˆã®èª¬æ˜"
}

Response:
{
  "message": "URLã®å†…å®¹ã‚’å–å¾—ã—ã€çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«è¿½åŠ ã—ã¾ã—ãŸ",
  "url": "https://example.com",
  "title": "ãƒšãƒ¼ã‚¸ã‚¿ã‚¤ãƒˆãƒ«"
}
```

#### 4. ç®¡ç†è€…æ©Ÿèƒ½

**ãƒãƒ£ãƒƒãƒˆå±¥æ­´å–å¾—**
```http
GET /chatbot/api/admin/chat-history
Authorization: Basic <credentials>

Query Parameters:
- user_id (optional): ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å±¥æ­´
- start_date (optional): é–‹å§‹æ—¥
- end_date (optional): çµ‚äº†æ—¥

Response:
[
  {
    "id": "chat_id",
    "user_message": "è³ªå•",
    "bot_response": "å›ç­”",
    "timestamp": "2024-01-01T10:00:00Z",
    "employee_name": "ç”°ä¸­å¤ªéƒ",
    "category": "ä¸€èˆ¬",
    "sentiment": "positive",
    "source_document": "ãƒãƒ‹ãƒ¥ã‚¢ãƒ«.pdf",
    "source_page": "1"
  }
]
```

**è©³ç´°åˆ†æ**
```http
POST /chatbot/api/admin/detailed-analysis
Authorization: Basic <credentials>
Content-Type: application/json

Request:
{
  "start_date": "2024-01-01",
  "end_date": "2024-01-31",
  "user_id": "user_id" // optional
}

Response:
{
  "total_messages": 100,
  "category_distribution": [
    {"category": "ä¸€èˆ¬", "count": 50},
    {"category": "æŠ€è¡“", "count": 30}
  ],
  "sentiment_distribution": [
    {"sentiment": "positive", "count": 60},
    {"sentiment": "neutral", "count": 30}
  ],
  "insights": "è©³ç´°ãªåˆ†æçµæœ..."
}
```

**ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†**
```http
POST /chatbot/api/admin/create-employee
Authorization: Basic <credentials>
Content-Type: application/json

Request:
{
  "email": "new@company.com",
  "password": "initial_password",
  "name": "æ–°ã—ã„å¾“æ¥­å“¡",
  "role": "employee"
}

Response:
{
  "message": "å¾“æ¥­å“¡ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ",
  "employee": {
    "id": "new_employee_id",
    "email": "new@company.com",
    "name": "æ–°ã—ã„å¾“æ¥­å“¡",
    "role": "employee"
  }
}
```

**ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†**
```http
GET /chatbot/api/admin/resources
Authorization: Basic <credentials>

Response:
[
  {
    "id": 1,
    "name": "ãƒãƒ‹ãƒ¥ã‚¢ãƒ«.pdf",
    "type": "pdf",
    "active": true,
    "uploaded_by": "user_id",
    "uploaded_at": "2024-01-01T10:00:00Z",
    "size": 1024000
  }
]

PUT /chatbot/api/admin/resources/{resource_id}/toggle
Authorization: Basic <credentials>

Response:
{
  "message": "ãƒªã‚½ãƒ¼ã‚¹ã®çŠ¶æ…‹ã‚’æ›´æ–°ã—ã¾ã—ãŸ",
  "active": false
}
```

#### 5. ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹

```http
HTTP/1.1 400 Bad Request
{
  "detail": "ãƒªã‚¯ã‚¨ã‚¹ãƒˆãŒç„¡åŠ¹ã§ã™"
}

HTTP/1.1 401 Unauthorized
{
  "detail": "èªè¨¼ãŒå¿…è¦ã§ã™"
}

HTTP/1.1 403 Forbidden
{
  "detail": "ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãŒã‚ã‚Šã¾ã›ã‚“"
}

HTTP/1.1 429 Too Many Requests
{
  "detail": "è³ªå•å›æ•°ã®åˆ¶é™ã«é”ã—ã¾ã—ãŸ"
}

HTTP/1.1 500 Internal Server Error
{
  "detail": "ã‚µãƒ¼ãƒãƒ¼å†…éƒ¨ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"
}
```

---

## ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

### æœ¬ç•ªç’°å¢ƒæ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Vercel        â”‚    â”‚    AWS EC2   â”‚    â”‚   Supabase      â”‚
â”‚   Frontend      â”‚â”€â”€â”€â–¶â”‚   Backend    â”‚â”€â”€â”€â–¶â”‚   PostgreSQL    â”‚
â”‚   (Static)      â”‚    â”‚   FastAPI    â”‚    â”‚   Database      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Google Cloud  â”‚
                    â”‚   Gemini API    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆAWS EC2ï¼‰

#### EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æº–å‚™

```bash
# Ubuntu 20.04 LTS æ¨å¥¨
sudo apt update
sudo apt install -y python3-pip nginx certbot python3-certbot-nginx git

# Pythonã¨pipã®æœ€æ–°åŒ–
sudo apt install -y python3.9 python3.9-venv python3.9-dev
```

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ—ãƒ­ã‚¤

```bash
# ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¯ãƒ­ãƒ¼ãƒ³
sudo mkdir -p /var/www
sudo chown $USER:$USER /var/www
cd /var/www
git clone https://github.com/your-repo/workmate.git
cd workmate/Chatbot-backend-main

# Pythonä»®æƒ³ç’°å¢ƒ
python3.9 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
playwright install

# ç’°å¢ƒå¤‰æ•°è¨­å®š
sudo nano /etc/environment
# æœ¬ç•ªç”¨ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®š
```

#### systemd ã‚µãƒ¼ãƒ“ã‚¹è¨­å®š

```bash
sudo nano /etc/systemd/system/workmate-backend.service
```

```ini
[Unit]
Description=Workmate Chatbot Backend
After=network.target

[Service]
Type=simple
User=www-data
Group=www-data
WorkingDirectory=/var/www/workmate/Chatbot-backend-main
Environment=PATH=/var/www/workmate/Chatbot-backend-main/venv/bin
EnvironmentFile=/etc/environment
ExecStart=/var/www/workmate/Chatbot-backend-main/venv/bin/uvicorn main:app --host 0.0.0.0 --port 8083
Restart=always
RestartSec=5

[Install]
WantedBy=multi-user.target
```

```bash
# ã‚µãƒ¼ãƒ“ã‚¹æœ‰åŠ¹åŒ–ãƒ»èµ·å‹•
sudo systemctl enable workmate-backend
sudo systemctl start workmate-backend
sudo systemctl status workmate-backend
```

#### Nginxè¨­å®š

```bash
sudo nano /etc/nginx/sites-available/workmate
```

```nginx
# HTTPãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
server {
    listen 80;
    server_name workmatechat.com www.workmatechat.com;
    
    # Let's Encryptèªè¨¼
    location /.well-known/acme-challenge/ {
        root /var/www/html;
    }
    
    # HTTPSãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
    location / {
        return 301 https://$host$request_uri;
    }
}

# HTTPS ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒãƒ¼
server {
    listen 443 ssl http2;
    server_name workmatechat.com www.workmatechat.com;
    
    # SSLè¨¼æ˜æ›¸
    ssl_certificate /etc/letsencrypt/live/workmatechat.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/workmatechat.com/privkey.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE+AESGCM:ECDHE+CHACHA20:DHE+AESGCM:DHE+CHACHA20:!aNULL:!MD5:!DSS;
    ssl_prefer_server_ciphers off;
    
    # ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼
    add_header X-Frame-Options DENY;
    add_header X-Content-Type-Options nosniff;
    add_header X-XSS-Protection "1; mode=block";
    add_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;
    
    # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºåˆ¶é™
    client_max_body_size 500M;
    
    # API ãƒ—ãƒ­ã‚­ã‚·
    location /chatbot/api/ {
        proxy_pass http://127.0.0.1:8083/chatbot/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
        
        # WebSocketå¯¾å¿œ
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
    
    # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆSPAå¯¾å¿œï¼‰
    location / {
        root /var/www/html;
        try_files $uri $uri/ /index.html;
        
        # ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
            expires 1y;
            add_header Cache-Control "public, immutable";
        }
        
        # HTMLãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã—ãªã„
        location = /index.html {
            expires -1;
            add_header Cache-Control "no-cache, no-store, must-revalidate";
        }
    }
    
    # ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸
    error_page 404 /404.html;
    error_page 500 502 503 504 /50x.html;
}
```

```bash
# Nginxè¨­å®šæœ‰åŠ¹åŒ–
sudo ln -s /etc/nginx/sites-available/workmate /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

#### SSLè¨¼æ˜æ›¸å–å¾—

```bash
# Let's Encryptè¨¼æ˜æ›¸å–å¾—
sudo certbot --nginx -d workmatechat.com -d www.workmatechat.com

# è‡ªå‹•æ›´æ–°è¨­å®š
sudo crontab -e
# ä»¥ä¸‹ã‚’è¿½åŠ :
0 12 * * * /usr/bin/certbot renew --quiet
```

### 2. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãƒ‡ãƒ—ãƒ­ã‚¤ï¼ˆVercelï¼‰

#### Vercelè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

```json
{
  "name": "workmate-frontend",
  "version": 2,
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/static-build",
      "config": { "distDir": "dist" }
    }
  ],
  "routes": [
    {
      "src": "/chatbot/api/(.*)",
      "dest": "https://workmatechat.com/chatbot/api/$1"
    },
    {
      "src": "/(.*)",
      "dest": "/index.html"
    }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "X-Frame-Options",
          "value": "DENY"
        },
        {
          "key": "X-Content-Type-Options",
          "value": "nosniff"
        },
        {
          "key": "X-XSS-Protection",
          "value": "1; mode=block"
        }
      ]
    }
  ],
  "env": {
    "VITE_API_URL": "https://workmatechat.com"
  }
}
```

#### ãƒ‡ãƒ—ãƒ­ã‚¤æ‰‹é †

1. **Vercelã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ**: GitHubé€£æº
2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè¨­å®š**:
   - Framework Preset: Vite
   - Build Command: `npm run build`
   - Output Directory: `dist`
   - Root Directory: `Chatbot-Frontend-main`
3. **ç’°å¢ƒå¤‰æ•°è¨­å®š**:
   ```
   VITE_API_URL=https://workmatechat.com
   ```
4. **è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤**: masterãƒ–ãƒ©ãƒ³ãƒã¸ã®pushã§è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤

### 3. CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

#### GitHub Actionsè¨­å®š

**.github/workflows/deploy-backend.yml**
```yaml
name: Deploy Backend to EC2

on:
  push:
    branches: [ master ]
    paths: 
      - 'Chatbot-backend-main/**'

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Deploy to EC2
      uses: appleboy/ssh-action@v0.1.5
      with:
        host: ${{ secrets.EC2_HOST }}
        username: ${{ secrets.EC2_USER }}
        key: ${{ secrets.EC2_SSH_KEY }}
        script: |
          cd /var/www/workmate
          git pull origin master
          cd Chatbot-backend-main
          source venv/bin/activate
          pip install -r requirements.txt
          sudo systemctl restart workmate-backend
          sudo systemctl status workmate-backend
```

**.github/workflows/deploy-frontend.yml**
```yaml
name: Deploy Frontend to Vercel

on:
  push:
    branches: [ master ]
    paths: 
      - 'Chatbot-Frontend-main/**'

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3
    
    - name: Setup Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '18'
        cache: 'npm'
        cache-dependency-path: 'Chatbot-Frontend-main/package-lock.json'
        
    - name: Install dependencies
      run: |
        cd Chatbot-Frontend-main
        npm ci
        
    - name: Build application
      run: |
        cd Chatbot-Frontend-main
        npm run build
        
    - name: Deploy to Vercel
      uses: amondnet/vercel-action@v20
      with:
        vercel-token: ${{ secrets.VERCEL_TOKEN }}
        vercel-org-id: ${{ secrets.ORG_ID }}
        vercel-project-id: ${{ secrets.PROJECT_ID }}
        working-directory: ./Chatbot-Frontend-main
```

#### å¿…è¦ãªGitHub Secrets

```bash
# EC2æ¥ç¶šè¨­å®š
EC2_HOST=your-ec2-public-ip
EC2_USER=ubuntu
EC2_SSH_KEY=<EC2ã®SSHç§˜å¯†éµå†…å®¹>

# Vercelè¨­å®š
VERCEL_TOKEN=<Vercelã®ã‚¢ã‚¯ã‚»ã‚¹ãƒˆãƒ¼ã‚¯ãƒ³>
ORG_ID=<Vercelã®Organization ID>
PROJECT_ID=<Vercelã®Project ID>

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­å®š
GOOGLE_API_KEY=<Google Gemini APIã‚­ãƒ¼>
SUPABASE_URL=<Supabase URL>
SUPABASE_KEY=<Supabase API Key>
```

### 4. æœ¬ç•ªç’°å¢ƒç›£è¦–

#### ã‚µãƒ¼ãƒãƒ¼ç›£è¦–

```bash
# ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
sudo nano /usr/local/bin/workmate-monitor.sh
```

```bash
#!/bin/bash

# Workmateç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
LOG_FILE="/var/log/workmate-monitor.log"
TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')

echo "[$TIMESTAMP] ç›£è¦–é–‹å§‹" >> $LOG_FILE

# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ãƒã‚§ãƒƒã‚¯
if systemctl is-active --quiet workmate-backend; then
    echo "[$TIMESTAMP] Backend: OK" >> $LOG_FILE
else
    echo "[$TIMESTAMP] Backend: ERROR - å†èµ·å‹•ä¸­" >> $LOG_FILE
    sudo systemctl restart workmate-backend
fi

# Nginx ãƒã‚§ãƒƒã‚¯
if systemctl is-active --quiet nginx; then
    echo "[$TIMESTAMP] Nginx: OK" >> $LOG_FILE
else
    echo "[$TIMESTAMP] Nginx: ERROR - å†èµ·å‹•ä¸­" >> $LOG_FILE
    sudo systemctl restart nginx
fi

# ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡ãƒã‚§ãƒƒã‚¯
DISK_USAGE=$(df / | awk 'NR==2 {print $5}' | sed 's/%//')
if [ $DISK_USAGE -gt 80 ]; then
    echo "[$TIMESTAMP] DISK: WARNING - ä½¿ç”¨é‡ ${DISK_USAGE}%" >> $LOG_FILE
fi

# ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ãƒã‚§ãƒƒã‚¯
MEMORY_USAGE=$(free | awk 'NR==2{printf "%.2f", $3*100/$2}')
echo "[$TIMESTAMP] Memory: ${MEMORY_USAGE}%" >> $LOG_FILE

echo "[$TIMESTAMP] ç›£è¦–å®Œäº†" >> $LOG_FILE
```

```bash
# ç›£è¦–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œå¯èƒ½ã«ã—ã€cronã«ç™»éŒ²
sudo chmod +x /usr/local/bin/workmate-monitor.sh
sudo crontab -e
# ä»¥ä¸‹ã‚’è¿½åŠ ï¼ˆ5åˆ†æ¯ã«ç›£è¦–ï¼‰:
*/5 * * * * /usr/local/bin/workmate-monitor.sh
```

#### ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

```bash
sudo nano /etc/logrotate.d/workmate
```

```
/var/log/workmate-monitor.log {
    daily
    missingok
    rotate 30
    compress
    create 644 root root
}

/var/www/workmate/Chatbot-backend-main/backend.log {
    daily
    missingok
    rotate 7
    compress
    create 644 www-data www-data
    postrotate
        systemctl reload workmate-backend
    endscript
}
```

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ã‚ˆãã‚ã‚‹å•é¡Œã¨è§£æ±ºæ–¹æ³•

#### 1. èªè¨¼ãƒ»ãƒ­ã‚°ã‚¤ãƒ³é–¢é€£

**å•é¡Œ**: ã€Œèªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸã€ã‚¨ãƒ©ãƒ¼

**åŸå› ã¨è§£æ±ºæ–¹æ³•**:
```bash
# 1. èªè¨¼æƒ…å ±ç¢ºèª
echo "dXNlckBleGFtcGxlLmNvbTpwYXNzd29yZA==" | base64 -d
# â†’ user@example.com:password

# 2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª
python3 -c "
from modules.database import get_db
try:
    db = next(get_db())
    print('Database: OK')
except Exception as e:
    print(f'Database Error: {e}')
"

# 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼å­˜åœ¨ç¢ºèª
python3 -c "
from supabase_adapter import select_data
result = select_data('users', filters={'email': 'user@example.com'})
print(f'User exists: {bool(result.data)}')
"
```

#### 2. AIå¿œç­”é–¢é€£

**å•é¡Œ**: AIå›ç­”ãŒé…ã„ãƒ»å›ç­”ã—ãªã„

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. Gemini APIã‚­ãƒ¼ç¢ºèª
python3 -c "
import os
print(f'API Key configured: {bool(os.getenv(\"GOOGLE_API_KEY\"))}')
"

# 2. APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
python3 -c "
import google.generativeai as genai
import os
genai.configure(api_key=os.getenv('GOOGLE_API_KEY'))
try:
    model = genai.GenerativeModel('gemini-2.0-flash-exp')
    response = model.generate_content('ãƒ†ã‚¹ãƒˆ')
    print('Gemini API: OK')
    print(f'Response: {response.text[:50]}...')
except Exception as e:
    print(f'Gemini API Error: {e}')
"

# 3. çŸ¥è­˜ãƒ™ãƒ¼ã‚¹ç¢ºèª
python3 -c "
from modules.resource import get_active_resources_by_company_id
import asyncio
async def check():
    resources = await get_active_resources_by_company_id(1, None)
    print(f'Active resources: {len(resources)}')
asyncio.run(check())
"
```

**å•é¡Œ**: ã€ŒçŸ¥è­˜ãƒ™ãƒ¼ã‚¹ã«é–¢é€£æƒ…å ±ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. ãƒªã‚½ãƒ¼ã‚¹çŠ¶æ…‹ç¢ºèª
python3 -c "
from supabase_adapter import select_data
result = select_data('document_sources', columns='name, active, company_id')
for doc in result.data:
    print(f'{doc[\"name\"]}: active={doc[\"active\"]}, company={doc[\"company_id\"]}')
"

# 2. ãƒªã‚½ãƒ¼ã‚¹å†æœ‰åŠ¹åŒ–
python3 -c "
from supabase_adapter import update_data
update_data('document_sources', {'active': True}, {'id': 'resource_id'})
"
```

#### 3. ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–¢é€£

**å•é¡Œ**: ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã«å¤±æ•—

**è¨ºæ–­ãƒ»è§£æ±º**:
```bash
# 1. ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºç¢ºèª
ls -lh uploaded_file.pdf
# PDF: 10MBä»¥ä¸‹, Excel: 5MBä»¥ä¸‹, Video: 500MBä»¥ä¸‹

# 2. ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ç¢ºèª
file uploaded_file.pdf
# æœŸå¾…å€¤: PDF document, Microsoft Excel, etc.

# 3. å‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ³ç¢ºèª
python3 -c "
try:
    import PyPDF2, pymupdf, openpyxl, pandas
    print('Document processors: OK')
except ImportError as e:
    print(f'Missing dependency: {e}')
"

# 4. OCRæ©Ÿèƒ½ç¢ºèª
python3 -c "
try:
    from PIL import Image
    import pdf2image
    print('OCR support: OK')
except ImportError as e:
    print(f'OCR Error: {e}')
"
```

#### 4. ã‚·ã‚¹ãƒ†ãƒ è² è·ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

**å•é¡Œ**: ã‚·ã‚¹ãƒ†ãƒ ãŒé‡ã„ãƒ»å¿œç­”ãŒé…ã„

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ºæ–­**:
```bash
# 1. ã‚·ã‚¹ãƒ†ãƒ ãƒªã‚½ãƒ¼ã‚¹ç¢ºèª
top -b -n1 | head -10
free -h
df -h

# 2. ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª
ps aux | grep -E "(python|uvicorn|nginx)"

# 3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç¢ºèª
netstat -tlnp | grep -E "(8083|80|443)"

# 4. ãƒ­ã‚°ç¢ºèª
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log
journalctl -u workmate-backend -f
```

**æœ€é©åŒ–æ‰‹é †**:
```bash
# 1. ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰æœ€é©åŒ–
# uvicorn ã®ãƒ¯ãƒ¼ã‚«ãƒ¼æ•°èª¿æ•´
ExecStart=/path/to/venv/bin/uvicorn main:app --host 0.0.0.0 --port 8083 --workers 4

# 2. Nginxæœ€é©åŒ–
# /etc/nginx/nginx.conf ã«è¿½åŠ 
worker_processes auto;
worker_connections 1024;

# 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ—ãƒ¼ãƒ«
# modules/database.py ã§èª¿æ•´
asyncpg.create_pool(min_size=5, max_size=20)
```

#### 5. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£

**å•é¡Œ**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚¨ãƒ©ãƒ¼

**è¨ºæ–­æ‰‹é †**:
```bash
# 1. Supabaseæ¥ç¶šç¢ºèª
python3 -c "
import os
from supabase import create_client
try:
    supabase = create_client(
        os.getenv('SUPABASE_URL'),
        os.getenv('SUPABASE_KEY')
    )
    result = supabase.table('users').select('id').limit(1).execute()
    print('Supabase: OK')
except Exception as e:
    print(f'Supabase Error: {e}')
"

# 2. ç’°å¢ƒå¤‰æ•°ç¢ºèª
echo "SUPABASE_URL: $SUPABASE_URL"
echo "SUPABASE_KEY: ${SUPABASE_KEY:0:20}..."

# 3. ãƒ†ãƒ¼ãƒ–ãƒ«å­˜åœ¨ç¢ºèª
python3 -c "
from supabase_adapter import select_data
tables = ['users', 'companies', 'chat_history', 'document_sources', 'usage_limits']
for table in tables:
    try:
        result = select_data(table, limit=1)
        print(f'{table}: OK ({len(result.data)} records)')
    except Exception as e:
        print(f'{table}: ERROR - {e}')
"
```

#### 6. ãƒ—ãƒ­ã‚­ã‚·ãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯é–¢é€£

**å•é¡Œ**: ãƒ—ãƒ­ã‚­ã‚·èªè¨¼ã‚¨ãƒ©ãƒ¼ (407 Proxy Authentication Required)

**è§£æ±ºæ–¹æ³•**:
```bash
# 1. ç’°å¢ƒå¤‰æ•°ã§ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
export HTTP_PROXY=http://username:password@proxy.company.com:8080
export HTTPS_PROXY=https://username:password@proxy.company.com:8080

# 2. .env ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ 
echo "HTTP_PROXY=http://proxy.company.com:8080" >> .env
echo "HTTPS_PROXY=https://proxy.company.com:8080" >> .env

# 3. ãƒ—ãƒ­ã‚­ã‚·å›é¿è¨­å®š
export NO_PROXY=localhost,127.0.0.1,supabase.co

# 4. Playwright ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
python3 -c "
from playwright.async_api import async_playwright
async def test():
    async with async_playwright() as p:
        browser = await p.chromium.launch(
            proxy={'server': 'http://proxy.company.com:8080'}
        )
"
```

#### 7. SSL/TLSè¨¼æ˜æ›¸é–¢é€£

**å•é¡Œ**: SSLè¨¼æ˜æ›¸ã‚¨ãƒ©ãƒ¼

**è¨ºæ–­ãƒ»è§£æ±º**:
```bash
# 1. è¨¼æ˜æ›¸ç¢ºèª
openssl x509 -in /etc/letsencrypt/live/workmatechat.com/fullchain.pem -text -noout

# 2. è¨¼æ˜æ›¸æœ‰åŠ¹æœŸé™ç¢ºèª
certbot certificates

# 3. è¨¼æ˜æ›¸æ›´æ–°
sudo certbot renew --dry-run
sudo certbot renew

# 4. Nginxè¨­å®šãƒ†ã‚¹ãƒˆ
sudo nginx -t

# 5. SSLè¨­å®šãƒ†ã‚¹ãƒˆ
curl -I https://workmatechat.com
```

### ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ä¸€è¦§

| HTTP Code | æ„å‘³ | ä¸€èˆ¬çš„ãªåŸå›  | è§£æ±ºæ–¹æ³• |
|-----------|------|-------------|----------|
| **400** | Bad Request | ãƒªã‚¯ã‚¨ã‚¹ãƒˆå½¢å¼ãŒä¸æ­£ | ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç¢ºèª |
| **401** | Unauthorized | èªè¨¼æƒ…å ±ãŒç„¡åŠ¹ | ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±ã‚’å†ç¢ºèª |
| **403** | Forbidden | ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ãªã— | ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™ã‚’ç¢ºèª |
| **404** | Not Found | ãƒªã‚½ãƒ¼ã‚¹ãŒå­˜åœ¨ã—ãªã„ | URLãƒ‘ã‚¹ã‚’ç¢ºèª |
| **413** | Payload Too Large | ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºè¶…é | ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºã‚’å‰Šæ¸› |
| **429** | Too Many Requests | åˆ©ç”¨åˆ¶é™åˆ°é” | æ™‚é–“ã‚’ãŠã„ã¦å†è©¦è¡Œ |
| **500** | Internal Server Error | ã‚µãƒ¼ãƒãƒ¼å†…éƒ¨ã‚¨ãƒ©ãƒ¼ | ãƒ­ã‚°ã‚’ç¢ºèªã—ã¦ã‚µãƒãƒ¼ãƒˆã«é€£çµ¡ |
| **502** | Bad Gateway | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç¢ºèª |
| **503** | Service Unavailable | ã‚µãƒ¼ãƒ“ã‚¹åˆ©ç”¨ä¸å¯ | ã‚µãƒ¼ãƒãƒ¼è² è·ã¾ãŸã¯ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ |

### ç·Šæ€¥æ™‚å¯¾å¿œ

#### ã‚µãƒ¼ãƒ“ã‚¹å¾©æ—§æ‰‹é †

**1. å®Œå…¨åœæ­¢æ™‚**
```bash
# å…¨ã‚µãƒ¼ãƒ“ã‚¹å†èµ·å‹•
sudo systemctl restart workmate-backend
sudo systemctl restart nginx

# çŠ¶æ…‹ç¢ºèª
sudo systemctl status workmate-backend
sudo systemctl status nginx
```

**2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å•é¡Œ**
```bash
# Supabaseæ¥ç¶šç¢ºèª
python3 -c "from modules.database import test_connection; test_connection()"

# ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†
# ä¸€æ™‚çš„ã«ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã§ã®å‹•ä½œã«åˆ‡ã‚Šæ›¿ãˆ
```

**3. AI APIåˆ¶é™**
```bash
# APIä½¿ç”¨é‡ç¢ºèª
# Google Cloud Console ã§Quotaç¢ºèª

# ä¸€æ™‚çš„ãªå¿œç­”è¨­å®š
# åˆ¶é™æ™‚ã¯å®šå‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§å¯¾å¿œ
```

---

## é‹ç”¨ãƒ»ä¿å®ˆ

### æ—¥å¸¸é‹ç”¨ã‚¿ã‚¹ã‚¯

#### æ¯æ—¥ã®ç¢ºèªé …ç›®

**ã‚·ã‚¹ãƒ†ãƒ çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯**
```bash
# è‡ªå‹•åŒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆ: daily-check.sh
#!/bin/bash

TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')
LOG_FILE="/var/log/workmate-daily.log"

echo "[$TIMESTAMP] æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯é–‹å§‹" >> $LOG_FILE

# 1. ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹
systemctl is-active --quiet workmate-backend && echo "Backend: OK" || echo "Backend: ERROR"
systemctl is-active --quiet nginx && echo "Nginx: OK" || echo "Nginx: ERROR"

# 2. APIå¿œç­”ç¢ºèª
curl -f https://workmatechat.com/chatbot/api/health && echo "API: OK" || echo "API: ERROR"

# 3. ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡
df -h | grep -E "(/$|/var)" 

# 4. åˆ©ç”¨çµ±è¨ˆ
python3 -c "
from supabase_adapter import select_data
from datetime import datetime, timedelta

yesterday = (datetime.now() - timedelta(days=1)).strftime('%Y-%m-%d')
result = select_data('chat_history', filters={'timestamp__gte': yesterday})
print(f'æ˜¨æ—¥ã®è³ªå•æ•°: {len(result.data) if result.data else 0}')
"

echo "[$TIMESTAMP] æ—¥æ¬¡ãƒã‚§ãƒƒã‚¯å®Œäº†" >> $LOG_FILE
```

#### é€±æ¬¡ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹

**1. ãƒ­ã‚°åˆ†æ**
```bash
# é€±æ¬¡ãƒ­ã‚°åˆ†æã‚¹ã‚¯ãƒªãƒ—ãƒˆ
#!/bin/bash

echo "=== é€±æ¬¡ãƒ­ã‚°åˆ†æ ==="

# ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°ç¢ºèª
echo "Nginx ã‚¨ãƒ©ãƒ¼ãƒ­ã‚° (éå»7æ—¥):"
grep -c "error" /var/log/nginx/error.log

echo "ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚¨ãƒ©ãƒ¼ (éå»7æ—¥):"
journalctl -u workmate-backend --since "7 days ago" | grep -c ERROR

# ã‚¢ã‚¯ã‚»ã‚¹çµ±è¨ˆ
echo "é€±é–“ã‚¢ã‚¯ã‚»ã‚¹çµ±è¨ˆ:"
awk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -rn | head -10
```

**2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æœ€é©åŒ–**
```python
# weekly-db-maintenance.py
from supabase_adapter import execute_query
from datetime import datetime, timedelta

# å¤ã„ãƒãƒ£ãƒƒãƒˆå±¥æ­´ã®çµ±è¨ˆé›†è¨ˆï¼ˆ3ãƒ¶æœˆä»¥ä¸Šå‰ï¼‰
three_months_ago = (datetime.now() - timedelta(days=90)).isoformat()

# ä½¿ç”¨çµ±è¨ˆæ›´æ–°
def update_usage_stats():
    query = """
    UPDATE usage_limits 
    SET updated_at = CURRENT_TIMESTAMP 
    WHERE updated_at < %s
    """
    execute_query(query, (three_months_ago,))

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±è¨ˆæ›´æ–°
def analyze_chat_patterns():
    query = """
    SELECT 
        DATE(timestamp) as date,
        COUNT(*) as question_count,
        COUNT(DISTINCT employee_id) as unique_users
    FROM chat_history 
    WHERE timestamp >= %s
    GROUP BY DATE(timestamp)
    ORDER BY date DESC
    """
    return execute_query(query, (three_months_ago,))
```

**3. ãƒªã‚½ãƒ¼ã‚¹æœ€é©åŒ–**
```bash
# æœªä½¿ç”¨ãƒªã‚½ãƒ¼ã‚¹ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
python3 -c "
from modules.admin import get_uploaded_resources
import asyncio

async def cleanup_unused_resources():
    resources = await get_uploaded_resources()
    for resource in resources:
        if not resource.get('active') and resource.get('last_accessed'):
            # 30æ—¥ä»¥ä¸Šã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã¦ã„ãªã„ç„¡åŠ¹ãƒªã‚½ãƒ¼ã‚¹ã‚’å‰Šé™¤å€™è£œã«
            print(f'å‰Šé™¤å€™è£œ: {resource[\"name\"]}')

asyncio.run(cleanup_unused_resources())
"
```

#### æœˆæ¬¡ä¿å®ˆ

**1. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ›´æ–°**
```bash
# ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ
sudo apt update && sudo apt upgrade -y

# Pythonä¾å­˜é–¢ä¿‚æ›´æ–°
cd /var/www/workmate/Chatbot-backend-main
source venv/bin/activate
pip list --outdated
# å¿…è¦ã«å¿œã˜ã¦å€‹åˆ¥ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆ

# Node.jsä¾å­˜é–¢ä¿‚ç¢ºèª
cd /var/www/workmate/Chatbot-Frontend-main
npm audit
npm audit fix
```

**2. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª**
```bash
# Supabaseè‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç¢ºèª
# Supabase Dashboard â†’ Settings â†’ Database â†’ Backups

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
tar -czf "/backup/workmate-config-$(date +%Y%m%d).tar.gz" \
    /etc/nginx/sites-available/workmate \
    /etc/systemd/system/workmate-backend.service \
    /var/www/workmate/Chatbot-backend-main/.env
```

**3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ**
```python
# monthly-performance-report.py
from supabase_adapter import select_data, execute_query
from datetime import datetime, timedelta
import json

def generate_monthly_report():
    last_month = (datetime.now() - timedelta(days=30)).isoformat()
    
    # åˆ©ç”¨çµ±è¨ˆ
    chat_stats = select_data(
        'chat_history',
        columns='COUNT(*) as total, AVG(LENGTH(user_message)) as avg_question_length',
        filters={'timestamp__gte': last_month}
    )
    
    # ãƒ¦ãƒ¼ã‚¶ãƒ¼å¢—åŠ ç‡
    user_stats = select_data(
        'users',
        columns='COUNT(*) as total, role',
        group_by='role'
    )
    
    # äººæ°—ã‚«ãƒ†ã‚´ãƒª
    category_stats = select_data(
        'chat_history',
        columns='category, COUNT(*) as count',
        filters={'timestamp__gte': last_month},
        group_by='category',
        order_by='count DESC'
    )
    
    report = {
        'period': last_month,
        'chat_statistics': chat_stats.data,
        'user_statistics': user_stats.data,
        'popular_categories': category_stats.data[:10]
    }
    
    with open(f'/var/log/workmate-monthly-{datetime.now().strftime("%Y%m")}.json', 'w') as f:
        json.dump(report, f, indent=2, ensure_ascii=False)
    
    return report
```

### ç›£è¦–ãƒ»ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

#### ã‚·ã‚¹ãƒ†ãƒ ç›£è¦–

**CloudWatchè¨­å®šï¼ˆAWS EC2ã®å ´åˆï¼‰**
```bash
# CloudWatch Agentã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
wget https://s3.amazonaws.com/amazoncloudwatch-agent/ubuntu/amd64/latest/amazon-cloudwatch-agent.deb
sudo dpkg -i amazon-cloudwatch-agent.deb

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
sudo nano /opt/aws/amazon-cloudwatch-agent/etc/amazon-cloudwatch-agent.json
```

```json
{
  "metrics": {
    "namespace": "WorkmateChatbot",
    "metrics_collected": {
      "cpu": {
        "measurement": ["cpu_usage_idle", "cpu_usage_iowait", "cpu_usage_user", "cpu_usage_system"],
        "metrics_collection_interval": 300
      },
      "disk": {
        "measurement": ["used_percent"],
        "metrics_collection_interval": 300,
        "resources": ["*"]
      },
      "mem": {
        "measurement": ["mem_used_percent"],
        "metrics_collection_interval": 300
      }
    }
  },
  "logs": {
    "logs_collected": {
      "files": {
        "collect_list": [
          {
            "file_path": "/var/log/nginx/access.log",
            "log_group_name": "workmate-nginx-access",
            "log_stream_name": "{instance_id}"
          },
          {
            "file_path": "/var/log/nginx/error.log",
            "log_group_name": "workmate-nginx-error",
            "log_stream_name": "{instance_id}"
          }
        ]
      }
    }
  }
}
```

#### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç›£è¦–

**ã‚«ã‚¹ã‚¿ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯**
```python
# modules/health.py
from fastapi import APIRouter
from datetime import datetime
import psutil
import os

router = APIRouter()

@router.get("/health")
async def health_check():
    """ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯"""
    
    # ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±
    cpu_percent = psutil.cpu_percent(interval=1)
    memory = psutil.virtual_memory()
    disk = psutil.disk_usage('/')
    
    # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèª
    try:
        from modules.database import get_db
        db = next(get_db())
        db_status = "OK"
    except Exception as e:
        db_status = f"ERROR: {str(e)}"
    
    # Gemini APIç¢ºèª
    try:
        import google.generativeai as genai
        genai.configure(api_key=os.getenv('GOOGLE_API_KEY'))
        model = genai.GenerativeModel('gemini-2.0-flash-exp')
        model.generate_content("test")
        ai_status = "OK"
    except Exception as e:
        ai_status = f"ERROR: {str(e)}"
    
    status_code = 200
    if db_status != "OK" or ai_status != "OK":
        status_code = 503
    
    return {
        "status": "healthy" if status_code == 200 else "unhealthy",
        "timestamp": datetime.now().isoformat(),
        "system": {
            "cpu_percent": cpu_percent,
            "memory_percent": memory.percent,
            "disk_percent": (disk.used / disk.total) * 100
        },
        "services": {
            "database": db_status,
            "ai_api": ai_status
        }
    }

@router.get("/metrics")
async def get_metrics():
    """Prometheuså½¢å¼ãƒ¡ãƒˆãƒªã‚¯ã‚¹"""
    from supabase_adapter import select_data
    
    # åŸºæœ¬çµ±è¨ˆ
    total_users = len(select_data('users').data or [])
    total_chats = len(select_data('chat_history').data or [])
    active_resources = len(select_data('document_sources', filters={'active': True}).data or [])
    
    metrics = f"""
# HELP workmate_users_total Total number of users
# TYPE workmate_users_total counter
workmate_users_total {total_users}

# HELP workmate_chats_total Total number of chat messages
# TYPE workmate_chats_total counter
workmate_chats_total {total_chats}

# HELP workmate_resources_active Number of active resources
# TYPE workmate_resources_active gauge
workmate_resources_active {active_resources}

# HELP workmate_system_cpu_percent CPU usage percentage
# TYPE workmate_system_cpu_percent gauge
workmate_system_cpu_percent {psutil.cpu_percent()}

# HELP workmate_system_memory_percent Memory usage percentage
# TYPE workmate_system_memory_percent gauge
workmate_system_memory_percent {psutil.virtual_memory().percent}
"""
    
    return Response(content=metrics, media_type="text/plain")
```

#### ã‚¢ãƒ©ãƒ¼ãƒˆè¨­å®š

**Slacké€šçŸ¥è¨­å®š**
```python
# modules/alerts.py
import requests
import json
import os
from datetime import datetime

def send_slack_alert(message, severity="info"):
    """Slackã‚¢ãƒ©ãƒ¼ãƒˆé€ä¿¡"""
    
    webhook_url = os.getenv('SLACK_WEBHOOK_URL')
    if not webhook_url:
        return
    
    color_map = {
        "info": "#36a64f",
        "warning": "#ff9900", 
        "error": "#ff0000",
        "critical": "#8B0000"
    }
    
    payload = {
        "attachments": [{
            "color": color_map.get(severity, "#36a64f"),
            "title": "Workmate ã‚·ã‚¹ãƒ†ãƒ ã‚¢ãƒ©ãƒ¼ãƒˆ",
            "text": message,
            "timestamp": datetime.now().timestamp()
        }]
    }
    
    try:
        response = requests.post(webhook_url, json=payload)
        response.raise_for_status()
    except Exception as e:
        print(f"Slacké€šçŸ¥ã‚¨ãƒ©ãƒ¼: {e}")

def check_system_health():
    """ã‚·ã‚¹ãƒ†ãƒ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ï¼†ã‚¢ãƒ©ãƒ¼ãƒˆ"""
    
    # CPUä½¿ç”¨ç‡ãƒã‚§ãƒƒã‚¯
    cpu_percent = psutil.cpu_percent(interval=1)
    if cpu_percent > 80:
        send_slack_alert(
            f"âš ï¸ CPUä½¿ç”¨ç‡ãŒé«˜ã„ã§ã™: {cpu_percent}%",
            "warning"
        )
    
    # ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãƒã‚§ãƒƒã‚¯
    memory_percent = psutil.virtual_memory().percent
    if memory_percent > 85:
        send_slack_alert(
            f"âš ï¸ ãƒ¡ãƒ¢ãƒªä½¿ç”¨ç‡ãŒé«˜ã„ã§ã™: {memory_percent}%",
            "warning"
        )
    
    # ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ãƒã‚§ãƒƒã‚¯
    disk_percent = (psutil.disk_usage('/').used / psutil.disk_usage('/').total) * 100
    if disk_percent > 90:
        send_slack_alert(
            f"ğŸš¨ ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨ç‡ãŒå±é™ºãƒ¬ãƒ™ãƒ«ã§ã™: {disk_percent}%",
            "critical"
        )
    
    # ã‚µãƒ¼ãƒ“ã‚¹çŠ¶æ…‹ãƒã‚§ãƒƒã‚¯
    try:
        import subprocess
        backend_status = subprocess.run(['systemctl', 'is-active', 'workmate-backend'], 
                                     capture_output=True, text=True)
        if backend_status.stdout.strip() != 'active':
            send_slack_alert(
                "ğŸš¨ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ãŒåœæ­¢ã—ã¦ã„ã¾ã™",
                "critical"
            )
    except Exception as e:
        send_slack_alert(
            f"ğŸš¨ ã‚µãƒ¼ãƒ“ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼: {e}",
            "error"
        )
```

### ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©æ—§

#### ãƒ‡ãƒ¼ã‚¿ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æˆ¦ç•¥

**1. Supabaseãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**
- **è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**: Supabaseã®è‡ªå‹•ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ã‚’æœ‰åŠ¹åŒ–
- **ãƒã‚¤ãƒ³ãƒˆã‚¤ãƒ³ã‚¿ã‚¤ãƒ å¾©æ—§**: éå»7æ—¥é–“ã®ä»»æ„ã®æ™‚ç‚¹ã«å¾©æ—§å¯èƒ½
- **æ‰‹å‹•ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ**: é‡è¦ãªå¤‰æ›´å‰ã«æ‰‹å‹•ã§ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆä½œæˆ

**2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**
```bash
# æ—¥æ¬¡ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
#!/bin/bash

BACKUP_DIR="/backup/workmate"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)
BACKUP_FILE="workmate_backup_${TIMESTAMP}.tar.gz"

# ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
mkdir -p $BACKUP_DIR

# ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
tar -czf "${BACKUP_DIR}/${BACKUP_FILE}" \
    --exclude="*/node_modules/*" \
    --exclude="*/venv/*" \
    --exclude="*/__pycache__/*" \
    --exclude="*/dist/*" \
    /var/www/workmate \
    /etc/nginx/sites-available/workmate \
    /etc/systemd/system/workmate-backend.service

# å¤ã„ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ï¼ˆ30æ—¥ä»¥ä¸Šå‰ï¼‰
find $BACKUP_DIR -name "workmate_backup_*.tar.gz" -mtime +30 -delete

echo "ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—å®Œäº†: ${BACKUP_FILE}"
```

**3. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—**
```bash
# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«å°‚ç”¨ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
CONFIG_BACKUP_DIR="/backup/config"
mkdir -p $CONFIG_BACKUP_DIR

# é‡è¦ãªè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’Gitãƒªãƒã‚¸ãƒˆãƒªã§ç®¡ç†
cd $CONFIG_BACKUP_DIR
git init
git add .
git commit -m "Config backup $(date)"

# ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã«è‡ªå‹•ãƒ—ãƒƒã‚·ãƒ¥
git push origin main
```

#### ç½å®³å¾©æ—§è¨ˆç”»

**1. å®Œå…¨å¾©æ—§æ‰‹é †**
```bash
# 1. æ–°ã—ã„EC2ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹æº–å‚™
# 2. åŸºæœ¬ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
sudo apt update
sudo apt install -y python3-pip nginx certbot python3-certbot-nginx git

# 3. ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰å¾©å…ƒ
cd /var/www
tar -xzf /backup/workmate/workmate_backup_latest.tar.gz

# 4. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
cd workmate/Chatbot-backend-main
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 5. ç’°å¢ƒå¤‰æ•°å¾©å…ƒ
# .env ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®‰å…¨ãªå ´æ‰€ã‹ã‚‰å¾©å…ƒ

# 6. ã‚µãƒ¼ãƒ“ã‚¹å†è¨­å®š
sudo systemctl enable workmate-backend
sudo systemctl start workmate-backend

# 7. Nginxè¨­å®šå¾©å…ƒ
sudo cp /backup/nginx/workmate /etc/nginx/sites-available/
sudo ln -s /etc/nginx/sites-available/workmate /etc/nginx/sites-enabled/
sudo systemctl restart nginx

# 8. SSLè¨¼æ˜æ›¸å¾©å…ƒ
sudo certbot --nginx -d workmatechat.com
```

**2. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å¾©æ—§**
```bash
# Supabaseã‹ã‚‰ã®å¾©æ—§
# 1. Supabase Dashboard â†’ Settings â†’ Database â†’ Backups
# 2. å¾©å…ƒã—ãŸã„æ™‚ç‚¹ã‚’é¸æŠ
# 3. Restore ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯

# æ‰‹å‹•å¾©æ—§ã®å ´åˆ
psql -h your-db-host -U postgres -d workmate < backup.sql
```

**3. éƒ¨åˆ†å¾©æ—§æ‰‹é †**
```bash
# ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®ã¿å¾©æ—§
sudo systemctl stop workmate-backend
cd /var/www/workmate/Chatbot-backend-main
git pull origin master
source venv/bin/activate
pip install -r requirements.txt
sudo systemctl start workmate-backend

# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿å¾©æ—§
# Vercel Dashboard â†’ Deployments â†’ Redeploy
```

### ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ç®¡ç†

#### å®šæœŸã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯

**1. è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³**
```bash
# Pythonä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
cd /var/www/workmate/Chatbot-backend-main
source venv/bin/activate
pip install safety
safety check

# Node.jsä¾å­˜é–¢ä¿‚ã®è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
cd /var/www/workmate/Chatbot-Frontend-main
npm audit

# ã‚·ã‚¹ãƒ†ãƒ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®è„†å¼±æ€§ãƒã‚§ãƒƒã‚¯
sudo apt list --upgradable | grep -i security
```

**2. ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°åˆ†æ**
```bash
# ä¸å¯©ãªã‚¢ã‚¯ã‚»ã‚¹ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
awk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -rn | head -20

# å¤±æ•—ã—ãŸãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œ
grep "401\|403" /var/log/nginx/access.log | tail -20

# å¤§é‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆã®æ¤œå‡º
awk '$9 !~ /^[23]/ {print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -rn
```

**3. ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯**
```bash
# é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
find /var/www/workmate -name "*.py" -exec md5sum {} \; > /tmp/file_hashes.txt
# å®šæœŸçš„ã«æ¯”è¼ƒã—ã¦å¤‰æ›´ã‚’æ¤œå‡º

# è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ç›£è¦–
sudo apt install aide
sudo aide --init
sudo mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db
sudo aide --check
```

#### ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡å¼·åŒ–

**1. IPåˆ¶é™è¨­å®š**
```nginx
# ç®¡ç†è€…ãƒ‘ãƒãƒ«ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
location /admin {
    allow 192.168.1.0/24;    # ç¤¾å†…ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯
    allow 203.0.113.0/24;    # VPNç¯„å›²
    deny all;
    
    # æ—¢å­˜ã®è¨­å®š...
}
```

**2. ãƒ¬ãƒ¼ãƒˆåˆ¶é™**
```nginx
# Nginx ãƒ¬ãƒ¼ãƒˆåˆ¶é™
http {
    limit_req_zone $binary_remote_addr zone=login:10m rate=5r/m;
    limit_req_zone $binary_remote_addr zone=api:10m rate=60r/m;
    
    server {
        location /chatbot/api/auth/ {
            limit_req zone=login burst=3 nodelay;
        }
        
        location /chatbot/api/ {
            limit_req zone=api burst=10 nodelay;
        }
    }
}
```

**3. ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®š**
```bash
# UFWè¨­å®š
sudo ufw enable
sudo ufw default deny incoming
sudo ufw default allow outgoing

# å¿…è¦ãªãƒãƒ¼ãƒˆã®ã¿é–‹æ”¾
sudo ufw allow ssh
sudo ufw allow 'Nginx Full'

# ç‰¹å®šIPã‹ã‚‰ã®ã¿SSHã‚¢ã‚¯ã‚»ã‚¹è¨±å¯
sudo ufw delete allow ssh
sudo ufw allow from 192.168.1.0/24 to any port 22
```

---

## ğŸ¯ ã¾ã¨ã‚

ã“ã®ä½¿ç”¨æ›¸ã§ã¯ã€Workmate AIãƒãƒ£ãƒƒãƒˆãƒœãƒƒãƒˆã‚·ã‚¹ãƒ†ãƒ ã®åŒ…æ‹¬çš„ãªæƒ…å ±ã‚’æä¾›ã—ã¾ã—ãŸã€‚

### é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ

1. **ã‚·ã‚¹ãƒ†ãƒ ç†è§£**: React + FastAPI + Supabase ã®æ§‹æˆ
2. **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£**: ä¼æ¥­ãƒ¬ãƒ™ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾å¿œ
3. **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: ãƒãƒ«ãƒãƒ†ãƒŠãƒ³ãƒˆå¯¾å¿œ
4. **é‹ç”¨æ€§**: ç›£è¦–ãƒ»ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ»å¾©æ—§ä½“åˆ¶

### ä»Šå¾Œã®ç™ºå±•

- **å¤šè¨€èªå¯¾å¿œ**: è‹±èªãƒ»ä¸­å›½èªã§ã®åˆ©ç”¨
- **APIæä¾›**: å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ é€£æº
- **éŸ³å£°å…¥åŠ›**: éŸ³å£°ã«ã‚ˆã‚‹è³ªå•å…¥åŠ›
- **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šçŸ¥**: é‡è¦æ›´æ–°ã®å³æ™‚é€šçŸ¥

### ã‚µãƒãƒ¼ãƒˆãƒ»é€£çµ¡å…ˆ

- **æŠ€è¡“çš„ãªå•é¡Œ**: queue@queuefood.co.jp
- **GitHub Issues**: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒã‚¸ãƒˆãƒª
- **ç·Šæ€¥æ™‚å¯¾å¿œ**: ç¤¾å†…ã‚¨ã‚¹ã‚«ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

---

**ğŸ“… æœ€çµ‚æ›´æ–°**: 2025å¹´1æœˆ13æ—¥  
**ğŸ“ ä½œæˆè€…**: Workmateé–‹ç™ºãƒãƒ¼ãƒ   
**ğŸ“ ã‚µãƒãƒ¼ãƒˆ**: queue@queuefood.co.jp

ã“ã®ä½¿ç”¨æ›¸ã¯å®šæœŸçš„ã«æ›´æ–°ã•ã‚Œã¾ã™ã€‚æœ€æ–°ç‰ˆã¯å¸¸ã«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªãƒã‚¸ãƒˆãƒªã§ç¢ºèªã—ã¦ãã ã•ã„ã€‚